SELECT
  `gaia_dr2_02`.`gaia_source`.`solution_id`,
  `gaia_dr2_02`.`gaia_source`.`designation`,
  `gaia_dr2_02`.`gaia_source`.`source_id`,
  `gaia_dr2_02`.`gaia_source`.`random_index`,
  `gaia_dr2_02`.`gaia_source`.`ref_epoch`,
  `gaia_dr2_02`.`gaia_source`.`ra`,
  `gaia_dr2_02`.`gaia_source`.`ra_error`,
  `gaia_dr2_02`.`gaia_source`.`dec`,
  `gaia_dr2_02`.`gaia_source`.`dec_error`,
  `gaia_dr2_02`.`gaia_source`.`parallax`,
  `gaia_dr2_02`.`gaia_source`.`parallax_error`,
  `gaia_dr2_02`.`gaia_source`.`parallax_over_error`,
  `gaia_dr2_02`.`gaia_source`.`pmra`,
  `gaia_dr2_02`.`gaia_source`.`pmra_error`,
  `gaia_dr2_02`.`gaia_source`.`pmdec`,
  `gaia_dr2_02`.`gaia_source`.`pmdec_error`,
  `gaia_dr2_02`.`gaia_source`.`ra_dec_corr`,
  `gaia_dr2_02`.`gaia_source`.`ra_parallax_corr`,
  `gaia_dr2_02`.`gaia_source`.`ra_pmra_corr`,
  `gaia_dr2_02`.`gaia_source`.`ra_pmdec_corr`,
  `gaia_dr2_02`.`gaia_source`.`dec_parallax_corr`,
  `gaia_dr2_02`.`gaia_source`.`dec_pmra_corr`,
  `gaia_dr2_02`.`gaia_source`.`dec_pmdec_corr`,
  `gaia_dr2_02`.`gaia_source`.`parallax_pmra_corr`,
  `gaia_dr2_02`.`gaia_source`.`parallax_pmdec_corr`,
  `gaia_dr2_02`.`gaia_source`.`pmra_pmdec_corr`,
  `gaia_dr2_02`.`gaia_source`.`astrometric_n_obs_al`,
  `gaia_dr2_02`.`gaia_source`.`astrometric_n_obs_ac`,
  `gaia_dr2_02`.`gaia_source`.`astrometric_n_good_obs_al`,
  `gaia_dr2_02`.`gaia_source`.`astrometric_n_bad_obs_al`,
  `gaia_dr2_02`.`gaia_source`.`astrometric_gof_al`,
  `gaia_dr2_02`.`gaia_source`.`astrometric_chi2_al`,
  `gaia_dr2_02`.`gaia_source`.`astrometric_excess_noise`,
  `gaia_dr2_02`.`gaia_source`.`astrometric_excess_noise_sig`,
  `gaia_dr2_02`.`gaia_source`.`astrometric_params_solved`,
  `gaia_dr2_02`.`gaia_source`.`astrometric_primary_flag`,
  `gaia_dr2_02`.`gaia_source`.`astrometric_weight_al`,
  `gaia_dr2_02`.`gaia_source`.`astrometric_pseudo_colour`,
  `gaia_dr2_02`.`gaia_source`.`astrometric_pseudo_colour_error`,
  `gaia_dr2_02`.`gaia_source`.`mean_varpi_factor_al`,
  `gaia_dr2_02`.`gaia_source`.`astrometric_matched_observations`,
  `gaia_dr2_02`.`gaia_source`.`visibility_periods_used`,
  `gaia_dr2_02`.`gaia_source`.`astrometric_sigma5d_max`,
  `gaia_dr2_02`.`gaia_source`.`frame_rotator_object_type`,
  `gaia_dr2_02`.`gaia_source`.`matched_observations`,
  `gaia_dr2_02`.`gaia_source`.`duplicated_source`,
  `gaia_dr2_02`.`gaia_source`.`phot_g_n_obs`,
  `gaia_dr2_02`.`gaia_source`.`phot_g_mean_flux`,
  `gaia_dr2_02`.`gaia_source`.`phot_g_mean_flux_error`,
  `gaia_dr2_02`.`gaia_source`.`phot_g_mean_flux_over_error`,
  `gaia_dr2_02`.`gaia_source`.`phot_g_mean_mag`,
  `gaia_dr2_02`.`gaia_source`.`phot_bp_n_obs`,
  `gaia_dr2_02`.`gaia_source`.`phot_bp_mean_flux`,
  `gaia_dr2_02`.`gaia_source`.`phot_bp_mean_flux_error`,
  `gaia_dr2_02`.`gaia_source`.`phot_bp_mean_flux_over_error`,
  `gaia_dr2_02`.`gaia_source`.`phot_bp_mean_mag`,
  `gaia_dr2_02`.`gaia_source`.`phot_rp_n_obs`,
  `gaia_dr2_02`.`gaia_source`.`phot_rp_mean_flux`,
  `gaia_dr2_02`.`gaia_source`.`phot_rp_mean_flux_error`,
  `gaia_dr2_02`.`gaia_source`.`phot_rp_mean_flux_over_error`,
  `gaia_dr2_02`.`gaia_source`.`phot_rp_mean_mag`,
  `gaia_dr2_02`.`gaia_source`.`phot_bp_rp_excess_factor`,
  `gaia_dr2_02`.`gaia_source`.`phot_proc_mode`,
  `gaia_dr2_02`.`gaia_source`.`bp_rp`,
  `gaia_dr2_02`.`gaia_source`.`bp_g`,
  `gaia_dr2_02`.`gaia_source`.`g_rp`,
  `gaia_dr2_02`.`gaia_source`.`radial_velocity`,
  `gaia_dr2_02`.`gaia_source`.`radial_velocity_error`,
  `gaia_dr2_02`.`gaia_source`.`rv_nb_transits`,
  `gaia_dr2_02`.`gaia_source`.`rv_template_teff`,
  `gaia_dr2_02`.`gaia_source`.`rv_template_logg`,
  `gaia_dr2_02`.`gaia_source`.`rv_template_fe_h`,
  `gaia_dr2_02`.`gaia_source`.`phot_variable_flag`,
  `gaia_dr2_02`.`gaia_source`.`l`,
  `gaia_dr2_02`.`gaia_source`.`b`,
  `gaia_dr2_02`.`gaia_source`.`ecl_lon`,
  `gaia_dr2_02`.`gaia_source`.`ecl_lat`,
  `gaia_dr2_02`.`gaia_source`.`priam_flags`,
  `gaia_dr2_02`.`gaia_source`.`teff_val`,
  `gaia_dr2_02`.`gaia_source`.`teff_percentile_lower`,
  `gaia_dr2_02`.`gaia_source`.`teff_percentile_upper`,
  `gaia_dr2_02`.`gaia_source`.`a_g_val`,
  `gaia_dr2_02`.`gaia_source`.`a_g_percentile_lower`,
  `gaia_dr2_02`.`gaia_source`.`a_g_percentile_upper`,
  `gaia_dr2_02`.`gaia_source`.`e_bp_min_rp_val`,
  `gaia_dr2_02`.`gaia_source`.`e_bp_min_rp_percentile_lower`,
  `gaia_dr2_02`.`gaia_source`.`e_bp_min_rp_percentile_upper`,
  `gaia_dr2_02`.`gaia_source`.`flame_flags`,
  `gaia_dr2_02`.`gaia_source`.`radius_val`,
  `gaia_dr2_02`.`gaia_source`.`radius_percentile_lower`,
  `gaia_dr2_02`.`gaia_source`.`radius_percentile_upper`,
  `gaia_dr2_02`.`gaia_source`.`lum_val`,
  `gaia_dr2_02`.`gaia_source`.`lum_percentile_lower`,
  `gaia_dr2_02`.`gaia_source`.`lum_percentile_upper`,
  scisql_angSep(`gs1`.`ra`, `gs1`.`dec`, `gs2`.`ra`, `gs2`.`dec`) AS `distance`
FROM
  `gaia_dr2_02`.`gaia_source` `gs1`,
  `gaia_dr2_02`.`gaia_source` `gs2`
WHERE
  scisql_angSep(`gs1`.`ra`, `gs1`.`dec`, `gs2`.`ra`, `gs2`.`dec`) < 0.016
  AND `gs1`.`source_id` <> `gs2`.`source_id`
LIMIT 10000;
