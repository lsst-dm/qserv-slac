SELECT ts.ra,ts.dec,ts.flux_g,ts.flux_i,ts.flux_r,ts.id,ts.is_pointsource,ts.is_variable,ts.truth_type,ts.mag_r,obj.objectId,obj.coord_ra,obj.coord_dec,scisql_nanojanskyToAbMag(obj.u_psfFlux) AS umag,scisql_nanojanskyToAbMag(obj.g_psfFlux) AS gmag,scisql_nanojanskyToAbMag(obj.r_psfFlux) AS rmag,scisql_nanojanskyToAbMag(obj.i_psfFlux) AS imag,scisql_nanojanskyToAbMag(obj.z_psfFlux) AS zmag,scisql_nanojanskyToAbMag(obj.y_psfFlux) AS ymag,scisql_nanojanskyToAbMagSigma(obj.u_psfFlux,obj.u_psfFluxErr) AS umagerr,scisql_nanojanskyToAbMagSigma(obj.g_psfFlux,obj.g_psfFluxErr) AS gmagerr,scisql_nanojanskyToAbMagSigma(obj.r_psfFlux,obj.r_psfFluxErr) AS rmagerr,scisql_nanojanskyToAbMagSigma(obj.i_psfFlux,obj.i_psfFluxErr) AS imagerr,scisql_nanojanskyToAbMagSigma(obj.z_psfFlux,obj.z_psfFluxErr) AS zmagerr,scisql_nanojanskyToAbMagSigma(obj.y_psfFlux,obj.y_psfFluxErr) AS ymagerr,scisql_nanojanskyToAbMag(obj.u_cModelFlux) AS umag_cmodel,scisql_nanojanskyToAbMag(obj.g_cModelFlux) AS gmag_cmodel,scisql_nanojanskyToAbMag(obj.r_cModelFlux) AS rmag_cmodel,scisql_nanojanskyToAbMag(obj.i_cModelFlux) AS imag_cmodel,scisql_nanojanskyToAbMag(obj.z_cModelFlux) AS zmag_cmodel,scisql_nanojanskyToAbMag(obj.y_cModelFlux) AS ymag_cmodel,scisql_nanojanskyToAbMagSigma(obj.u_cModelFlux,obj.u_cModelFluxErr) AS umagerr_cmodel,scisql_nanojanskyToAbMagSigma(obj.g_cModelFlux,obj.g_cModelFluxErr) AS gmagerr_cmodel,scisql_nanojanskyToAbMagSigma(obj.r_cModelFlux,obj.r_cModelFluxErr) AS rmagerr_cmodel,scisql_nanojanskyToAbMagSigma(obj.i_cModelFlux,obj.i_cModelFluxErr) AS imagerr_cmodel,scisql_nanojanskyToAbMagSigma(obj.z_cModelFlux,obj.z_cModelFluxErr) AS zmagerr_cmodel,scisql_nanojanskyToAbMagSigma(obj.y_cModelFlux,obj.y_cModelFluxErr) AS ymagerr_cmodel,obj.g_psfFlux,obj.r_psfFlux,obj.i_psfFlux,obj.g_cModelFlux,obj.r_cModelFlux,obj.i_cModelFlux,obj.g_psfFluxErr,obj.r_psfFluxErr,obj.i_psfFluxErr,obj.g_cModelFluxErr,obj.r_cModelFluxErr,obj.i_cModelFluxErr,obj.tract,obj.patch,obj.g_extendedness,obj.r_extendedness,obj.i_extendedness,obj.g_blendedness,obj.r_blendedness,obj.i_blendedness,obj.detect_isPrimary FROM dp02_dc2_catalogs.MatchesTruth AS mt JOIN dp02_dc2_catalogs.TruthSummary AS ts ON ts.id_truth_type=mt.id_truth_type JOIN dp02_dc2_catalogs.Object AS obj ON mt.match_objectId=obj.objectId WHERE scisql_s2PtInCircle(ts.ra,ts.dec,64.5,-37.0,2.0)=1 AND ts.mag_r < 28
